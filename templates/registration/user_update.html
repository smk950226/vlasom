{% extends "base/base.html" %}
{% load static bootstrap4 %}

{% block content %}
<section class="section-1">
    <div class="container text-center mrg-top-50">
        <h1 class="theme-color">My Profile</h1>
        <form action="" method="post" enctype="multipart/form-data">
            {% csrf_token %}
            <div class="row mrg-top-60">   
                <div class="portfolio col-xs-12 col-md-5 profile-wrapper no-pdd" style="cursor:pointer;">
                    <div id="profile_image_wrapper" class="folio-item">
                        <div class="folio-style-3">
                            <div class="folio-image">
                                <img id="profile_img" class="img-responsive" src="{{ request.user.profile_image.url }}" alt="">
                            </div><!-- /folio-image -->
                            <div class="overlay">								
                            </div><!-- /overlay -->
                            <div class="folio-caption theme-color-bg-opacity">
                                <div class="pull-left">
                                    <h3 class="folio-tittle"><a class="text-white" href=""><img src="{% static "images/logo-img-overlap.png" %}" alt=""> 수정하기</a></h3>
                                </div><!-- /pull-left -->
                            </div><!-- /folio-caption -->
                        </div><!-- folio-style -->
                    </div><!-- /folio-item -->
                    <div style="display: none;">
                        {% bootstrap_field form.profile_image show_label=False form_group_class='' %}
                    </div>
                </div>
                <div class="col-xs-12 col-md-6 col-md-offset-1">
                    <div class="row">
                        <div class="col-xs-4">
                            <div class="input-label">
                                <h3>ID</h3>
                            </div>
                        </div>
                        <div class="col-xs-5 no-pdd-left">
                            <div class="input-box bg-gray">
                                <h3>{{ request.user.login_id }}</h3>
                            </div>
                        </div>
                        <div class="col-xs-3">
                            <div class="input-box-border-all text-center">
                                <div style="margin-top: -3px;">
                                    <input type="radio" name="gender" value="M" required id="id_gender_1" {% if request.user.gender == 'M' %}checked{% endif %}>
                                    {% if request.user.gender == 'M' %}
                                    <label id="gender_1_label" for="id_gender_1"><img src="{% static "images/male.png" %}" width="30" alt=""></label>
                                    {% else %}
                                    <label id="gender_1_label" for="id_gender_1"><img src="{% static "images/male-before.png" %}" width="30" alt=""></label>
                                    {% endif %}
                                    <input type="radio" name="gender" value="F" required id="id_gender_2" {% if request.user.gender == 'F' %}checked{% endif %}>
                                    {% if request.user.gender == 'F' %}
                                    <label id="gender_2_label" for="id_gender_2"><img src="{% static "images/female.png" %}" width="30" alt=""></label>
                                    {% else %}
                                    <label id="gender_2_label" for="id_gender_2"><img src="{% static "images/female-before.png" %}" width="30" alt=""></label>
                                    {% endif %}
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row mrg-top-15">
                        <div class="col-xs-4">
                            <div class="input-label">
                                <h3>Name</h3>
                            </div>
                        </div>
                        <div class="col-xs-8 no-pdd-left">
                            {% bootstrap_field form.name show_label=False form_group_class='' %}
                        </div>
                    </div>
                    <div class="row mrg-top-15">
                        <div class="col-xs-4">
                            <div class="input-label">
                                <h3>Nicname</h3>
                            </div>
                        </div>
                        <div class="col-xs-8 no-pdd-left">
                            {% bootstrap_field form.nickname show_label=False form_group_class='' %}
                        </div>
                    </div>
                    <div class="row mrg-top-15">
                        <div class="col-xs-4">
                            <div class="input-label">
                                <h3>E-mail</h3>
                            </div>
                        </div>
                        <div class="col-xs-8 no-pdd-left">
                            <div class="input-box bg-gray">
                                <h3>{{ request.user.email }}</h3>
                            </div>
                        </div>
                    </div>
                    <div class="row mrg-top-15">
                        <div class="col-xs-4">
                            <div class="input-label">
                                <h3>Birth</h3>
                            </div>
                        </div>
                        <div class="col-xs-8 no-pdd-left">
                            {% bootstrap_field form.birth_year show_label=False show_help=False form_group_class='col-xs-4 no-pdd-horizon' %}
                            {% bootstrap_field form.birth_month show_label=False show_help=False form_group_class='col-xs-4 no-pdd-horizon' %}
                            {% bootstrap_field form.birth_day show_label=False show_help=False form_group_class='col-xs-4 no-pdd-horizon' %}
                        </div>
                    </div>
                    <div class="row mrg-top-15">
                        <div class="col-xs-12 text-right">
                            <a href="{% url "password_change" %}" class="btn btn-md btn-round btn-theme-inverse-to-theme">비밀번호 변경</a>
                            <input type="submit" class="btn btn-md btn-round btn-theme-inverse-to-theme" value="변경사항 저장">
                        </div>
                    </div>
                </div>
            </div>
        </form>
    </div>
</section>
{% bootstrap_form_errors form %}
{% endblock %}
{% block extrajs %}
<script>
    $('input:radio[name="gender"]').on('change', function(){
        if($('#id_gender_1').is(':checked')){
            $('#gender_1_label').html('<img src="{% static "images/male.png" %}" width="30" alt="">');
        }
        else{
            $('#gender_1_label').html('<img src="{% static "images/male-before.png" %}" width="30" alt="">');
        }
        if($('#id_gender_2').is(':checked')){
            $('#gender_2_label').html('<img src="{% static "images/female.png" %}" width="30" alt="">');
        }
        else{
            $('#gender_2_label').html('<img src="{% static "images/female-before.png" %}" width="30" alt="">');
        }
    });

    $('#profile_image_wrapper').on('click', function(){
        $('#id_profile_image').trigger('click');
    })

    $('#id_profile_image').on('change', function(){
        if (this.files && this.files[0]){
            var reader = new FileReader();
            reader.onload = function(e){
                $('#profile_img').attr({'src': e.target.result});
            }
            reader.readAsDataURL(this.files[0])
        } 
    })
</script>
{% endblock %}